// ext makes method callable project wide
ext.getVersionName = { ->
    try {
        def branchout = new ByteArrayOutputStream()
        exec {
            commandLine 'git', 'rev-parse', '--abbrev-ref', 'HEAD'
            standardOutput = branchout
        }
        def branch = branchout.toString().trim()

        if (branch.equals("master")) {
            def stdout = new ByteArrayOutputStream()
            exec {
                commandLine 'git', 'describe', '--tags'
                standardOutput = stdout
            }
            return stdout.toString().trim()
        } else {
            return branch;
        }
    } catch (ignored) {
        return null;
    }
}

/**
 * New Functions
 * */
ext.uploadFile = { String variantName ->
    def destPath = '/sdcard/AndroidStudioFiles'
    try {
        exec {
            commandLine 'cmd', '/c', 'adb', 'shell', 'mkdir', destPath
        }
        exec {
            commandLine 'cmd', '/c', 'adb', 'push', project.name + '-' + variantName + '.apk', destPath
            workingDir project.buildDir.toString() + '/outputs/apk/' + variantName + '/'
        }
    } catch (Exception ignored) {
    }
}